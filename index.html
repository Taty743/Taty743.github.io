<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Scanner with Push Notifications</title>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.8.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.8.0/firebase-messaging.js"></script>
</head>
<body>
    <h1>Barcode Scanner</h1>

    <!-- Video element to display camera feed -->
    <video id="video" width="300" height="300" autoplay></video>
    
    <p>Scanned Barcode: <span id="output"></span></p>

    <h2>Scanned Barcodes:</h2>
    <ul id="barcode-list"></ul>

    <script>
        // Firebase configuration (replace with your own config from Firebase Console)
        const firebaseConfig = {
            apiKey: "your-api-key",
            authDomain: "your-auth-domain.firebaseapp.com",
            projectId: "your-project-id",
            storageBucket: "your-storage-bucket.appspot.com",
            messagingSenderId: "your-sender-id",
            appId: "your-app-id",
            measurementId: "your-measurement-id"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const messaging = firebase.messaging();

        // Request notification permission from the user
        async function requestPermission() {
            try {
                await Notification.requestPermission();
                if (Notification.permission === "granted") {
                    console.log("Notification permission granted.");
                    // Get the registration token
                    const token = await messaging.getToken({ vapidKey: "your-vapid-key" });
                    console.log("FCM Token:", token);
                    // You can send this token to your backend to send notifications
                } else {
                    console.log("Notification permission denied.");
                }
            } catch (error) {
                console.error("Error getting notification permission:", error);
            }
        }

        // Call this function to start requesting permission
        requestPermission();

        // Listen for foreground notifications
        messaging.onMessage((payload) => {
            console.log("Message received: ", payload);
            // Customize how you want to display the notification in the web app
            new Notification(payload.notification.title, {
                body: payload.notification.body,
                icon: payload.notification.icon,
            });
        });
    </script>
</body>
</html>
